{"ast":null,"code":"var _jsxFileName = \"D:\\\\perpus\\\\frontendd\\\\src\\\\context\\\\auth.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Role = {\n  Admin: \"1\",\n  Petugas: \"2\",\n  User: \"3\"\n};\nconst AuthContext = /*#__PURE__*/createContext(undefined);\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [token, setToken] = useState(() => {\n    if (typeof window !== \"undefined\") {\n      return window.localStorage.getItem(\"Key_Token\");\n    }\n    return null;\n  });\n  useEffect(() => {\n    if (token) {\n      localStorage.setItem(\"Key_Token\", token);\n    }\n  }, [token]);\n  const login = token => {\n    setToken(token);\n    localStorage.setItem(\"Key_Token\", token);\n  };\n  const logout = () => {\n    localStorage.removeItem(\"Key_Token\");\n    setToken(null);\n  };\n  const isLogin = () => {\n    return token !== null;\n  };\n  const isRole = () => {\n    if (token == null) return null;\n    try {\n      const provider = JSON.parse(atob(token.split(\".\")[1]));\n      console.log(provider); // Debugging, lihat isi payload token\n\n      // Mengambil role dari payload\n      const roleID = provider.role; // Pastikan untuk mengambil 'role' di sini\n      switch (roleID) {\n        case 1:\n          return 'Admin';\n        case 2:\n          return 'Petugas';\n        case 3:\n          return 'User';\n        default:\n          return null;\n      }\n    } catch (error) {\n      console.error('Format token tidak valid', error);\n      return null;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      token,\n      login,\n      logout,\n      isLogin: isLogin(),\n      isRole: isRole()\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 9\n  }, this);\n};\n_s(AuthProvider, \"C+YSbFoMrjvi4zrfM5A23F5XbZc=\");\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n  const auth = useContext(AuthContext);\n  if (auth === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return auth;\n};\n_s2(useAuth, \"2E+KaGHVlJMhtGjyKmHdHkA1EKU=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","jsxDEV","_jsxDEV","Role","Admin","Petugas","User","AuthContext","undefined","AuthProvider","children","_s","token","setToken","window","localStorage","getItem","setItem","login","logout","removeItem","isLogin","isRole","provider","JSON","parse","atob","split","console","log","roleID","role","error","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","auth","Error","$RefreshReg$"],"sources":["D:/perpus/frontendd/src/context/auth.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from \"react\";\r\n\r\nexport const Role = {\r\n    Admin: \"1\",\r\n    Petugas: \"2\",\r\n    User: \"3\",\r\n};\r\n\r\nconst AuthContext = createContext(undefined);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [token, setToken] = useState(() => {\r\n        if (typeof window !== \"undefined\") {\r\n            return window.localStorage.getItem(\"Key_Token\");\r\n        }\r\n        return null;\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (token) {\r\n            localStorage.setItem(\"Key_Token\", token);\r\n        }\r\n    }, [token]);\r\n\r\n    const login = (token) => {\r\n        setToken(token);\r\n        localStorage.setItem(\"Key_Token\", token);\r\n    };\r\n\r\n    const logout = () => {\r\n        localStorage.removeItem(\"Key_Token\");\r\n        setToken(null);\r\n    };\r\n\r\n    const isLogin = () => {\r\n        return token !== null;\r\n    };\r\n\r\n    const isRole = () => {\r\n        if (token == null) return null;\r\n    \r\n        try {\r\n            const provider = JSON.parse(atob(token.split(\".\")[1]));\r\n            console.log(provider);  // Debugging, lihat isi payload token\r\n    \r\n            // Mengambil role dari payload\r\n            const roleID = provider.role; // Pastikan untuk mengambil 'role' di sini\r\n            switch (roleID) {\r\n                case 1:\r\n                    return 'Admin';\r\n                case 2:\r\n                    return 'Petugas';\r\n                case 3:\r\n                    return 'User';\r\n                default:\r\n                    return null;\r\n            }\r\n        } catch (error) {\r\n            console.error('Format token tidak valid', error);\r\n            return null;\r\n        }\r\n    };  \r\n    \r\n\r\n    return (\r\n        <AuthContext.Provider\r\n            value={{\r\n                token,\r\n                login,\r\n                logout,\r\n                isLogin: isLogin(),\r\n                isRole: isRole(),\r\n            }}\r\n        >\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAuth = () => {\r\n    const auth = useContext(AuthContext);\r\n    if (auth === undefined) {\r\n        throw new Error(\"useAuth must be used within an AuthProvider\");\r\n    }\r\n    return auth;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}